<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>QNA Travel</title>
  <style>
    :root{
      --bg:#f7f7f7; --card:#fff; --text:#111; --muted:#666; --border:#ddd;
      --brand:#111; --brandText:#fff;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans TC",sans-serif;background:var(--bg);color:var(--text)}
    header{position:sticky;top:0;z-index:9;background:rgba(255,255,255,.9);backdrop-filter:blur(8px);border-bottom:1px solid var(--border)}
    .topbar{max-width:980px;margin:0 auto;padding:12px 16px;display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{font-weight:700;letter-spacing:.2px}
    nav{display:flex;gap:14px;flex-wrap:wrap}
    nav a{color:var(--text);text-decoration:none;font-size:14px}
    nav a.active{text-decoration:underline;font-weight:600}
    .container{max-width:980px;margin:18px auto;padding:0 16px}
    .grid{display:grid;gap:12px}
    @media(min-width:860px){ .grid-2{grid-template-columns:1.2fr .8fr} .grid-3{grid-template-columns:repeat(3,1fr)}}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px}
    .title{font-size:22px;font-weight:700;margin:0 0 8px}
    .muted{color:var(--muted);font-size:14px}
    .btn{display:inline-flex;align-items:center;gap:8px;background:var(--brand);color:var(--brandText);border:none;border-radius:10px;padding:8px 12px;font-size:14px;cursor:pointer}
    .btn.secondary{background:#fff;color:#111;border:1px solid var(--border)}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .pill{border:1px solid var(--border);border-radius:999px;padding:6px 10px;font-size:12px;background:#fff;cursor:pointer}
    .pill.active{background:#111;color:#fff;border-color:#111}
    .list{display:flex;flex-direction:column;gap:10px}
    .item{display:flex;align-items:flex-start;justify-content:space-between;gap:10px}
    .item h3{margin:0;font-size:16px}
    .item p{margin:3px 0 0;color:var(--muted);font-size:13px}
    .badge{font-size:12px;border:1px solid var(--border);border-radius:10px;padding:6px 8px;background:#fff}
    .timeline{display:flex;flex-direction:column;gap:12px;margin-top:10px}
    .trow{display:grid;grid-template-columns:70px 1fr;gap:12px}
    .time{color:var(--muted);font-size:13px}
    .hr{height:1px;background:var(--border);margin:12px 0}
    input, select{border:1px solid var(--border);border-radius:10px;padding:10px 12px;font-size:14px;background:#fff;outline:none}
    input:focus,select:focus{border-color:#aaa}
    .right{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .star{cursor:pointer;user-select:none;font-size:18px;line-height:1}
    .star.on{color:#f5a623}
    .small{font-size:12px;color:var(--muted)}
    .footerNote{margin-top:10px;color:var(--muted);font-size:12px}
  </style>
</head>
<body>

<header>
  <div class="topbar">
    <div class="brand">QNA Travel ✈️</div>
    <nav id="nav">
<nav>
  <a href="#" onclick="showHome()">Home</a>
  <a href="#" onclick="showItinerary()">Itinerary</a>
  <a href="#" onclick="showTrips()">Trips</a>
  <a href="#" onclick="showExplore()">Explore</a>
</nav>
  </div>
</header>

<div class="container" id="app"></div>
function showItinerary(){
  app.innerHTML = `
    <div class="card">
      <h2>Itinerary（行程表）</h2>
      <p style="color:#666;margin-top:6px;">${trips[0].city} · ${trips[0].days} days</p>
      <div style="margin-top:14px;">
        ${itinerary.map(d => `
          <div class="card" style="margin:12px 0;">
            <h3 style="margin:0 0 6px;">Day ${d.day} (${d.date}) · ${d.city}${d.move ? ` <span style="color:#666;font-weight:400;">｜${d.move}</span>` : ""}</h3>
            ${d.items.map(i => `
              <div style="display:grid;grid-template-columns:70px 1fr;gap:10px;padding:6px 0;border-top:1px solid #eee;">
                <div style="color:#666;font-size:13px;">${i.period}</div>
                <div>
                  <div>${i.zh}｜${i.en}</div>
                </div>
              </div>
            `).join("")}
          </div>
        `).join("")}
      </div>
    </div>
  `;
}

<script>
/** --------------------------
 *  Data (你可以在這裡改成你的行程)
 * -------------------------- */
const trips = [
  { id:"italy", name:"Italy Trip", city:"Rome → Florence → Venice → Rome", days:7 }
];

// places: 你可以繼續加更多
const places = [
const itinerary = [
  {
    day: 1, date: "4/5", city: "Florence", move: "Rome → Florence",
    items: [
      { period:"上午", zh:"羅馬搭高鐵前往佛羅倫斯", en:"Train from Rome to Florence" },
      { period:"下午", zh:"佛羅倫斯主教座堂（外觀）", en:"Florence Cathedral (Duomo, exterior)" },
      { period:"下午", zh:"主教座堂廣場", en:"Piazza del Duomo" },
      { period:"傍晚", zh:"領主廣場", en:"Piazza della Signoria" },
      { period:"晚上", zh:"米開朗基羅廣場看夕陽", en:"Piazzale Michelangelo viewpoint" },
    ]
  },
  {
    day: 2, date: "4/6", city: "Florence",
    items: [
      { period:"上午", zh:"聖母百花大教堂參觀", en:"Florence Cathedral (Duomo, exterior)" },
      { period:"下午", zh:"比薩斜塔", en:"Pisa" },
      { period:"傍晚", zh:"老橋夜景", en:"Ponte Vecchio" },
    ]
  },
  {
    day: 3, date: "4/7", city: "Venice", move:"Florence → Venice",
    items: [
      { period:"上午", zh:"佛羅倫斯搭高鐵前往威尼斯", en:"Train from Florence to Venice" },
      { period:"下午", zh:"聖馬可廣場", en:"St Mark's Square" },
      { period:"傍晚", zh:"聖馬可大教堂（外觀）", en:"St Mark's Basilica (exterior)" },
      { period:"晚上", zh:"總督宮（外觀）", en:"Doge's Palace (exterior)" },
    ]
  },
  {
    day: 4, date: "4/8", city: "Venice",
    items: [
      { period:"上午", zh:"里亞托橋", en:"Rialto Bridge" },
      { period:"上午", zh:"里亞托市場", en:"Rialto Market" },
      { period:"下午", zh:"搭上浪漫的貢多拉", en:"Gondola Time" },
      { period:"傍晚", zh:"學院橋夕景", en:"Accademia Bridge" },
    ]
  },
  {
    day: 5, date: "4/9", city: "Rome", move:"Venice → Rome",
    items: [
      { period:"上午", zh:"威尼斯搭高鐵回羅馬", en:"Train from Venice to Rome" },
      { period:"下午", zh:"梵蒂岡城國散步", en:"Vatican City walk" },
      { period:"下午", zh:"聖彼得廣場", en:"St. Peter’s Square" },
      { period:"傍晚", zh:"聖彼得大教堂（外觀）", en:"St. Peter’s Basilica (exterior)" },
      { period:"晚上", zh:"聖天使堡（外觀散步）", en:"Castel Sant’Angelo (exterior)" },
    ]
  },
  {
    day: 6, date: "4/10", city: "Rome",
    items: [
      { period:"上午", zh:"羅馬競技場", en:"Colosseum" },
      { period:"上午", zh:"古羅馬廣場（外圍散步）", en:"Roman Forum (outside area walk)" },
      { period:"中午", zh:"真理之口拍照", en:"Bocca della Verità" },
      { period:"傍晚", zh:"威尼斯廣場", en:"Piazza Venezia" },
    ]
  },
  {
    day: 7, date: "4/11", city: "Rome",
    items: [
      { period:"上午", zh:"萬神殿（外觀）", en:"Pantheon (exterior)" },
      { period:"中午", zh:"納沃納廣場", en:"Piazza Navona" },
      { period:"下午", zh:"特雷維噴泉", en:"Trevi Fountain" },
      { period:"傍晚", zh:"西班牙台階", en:"Spanish Steps" },
    ]
  }
];


const placeById = Object.fromEntries(places.map(p=>[p.id,p]));

/** --------------------------
 *  Favorites (localStorage)
 * -------------------------- */
const FAV_KEY = "qna_travel_favs";
function getFavs(){ try { return new Set(JSON.parse(localStorage.getItem(FAV_KEY) || "[]")); } catch { return new Set(); } }
function saveFavs(set){ localStorage.setItem(FAV_KEY, JSON.stringify([...set])); }
let favs = getFavs();

function star(placeId){
  const on = favs.has(placeId);
  favs[on ? "delete" : "add"](placeId);
  saveFavs(favs);
  render(); // 重新渲染
}

/** --------------------------
 *  Router
 * -------------------------- */
function setActive(route){
  document.querySelectorAll("#nav a").forEach(a=>{
    a.classList.toggle("active", a.dataset.route === route);
  });
}
function route(){
  const hash = (location.hash || "#home").replace("#","");
  return hash;
}
window.addEventListener("hashchange", render);

function render(){
  const r = route();
  setActive(r);
  if(r === "home") return renderHome();
  if(r === "trips") return renderTrips();
  if(r === "explore") return renderExplore();
  if(r === "itinerary") return renderItinerary();
  // fallback
  location.hash = "#home";
}

/** --------------------------
 *  Views
 * -------------------------- */
function renderHome(){
  const t = trips[0];
  app.innerHTML = `
    <div class="grid grid-2">
      <div class="card">
        <div class="muted">Next Trip</div>
        <h1 class="title">${t.name}</h1>
        <div class="muted">${t.city} · ${t.days} days · ${t.date}</div>
        <div class="hr"></div>
        <div class="row">
          <button class="btn" onclick="location.hash='#itinerary'">查看行程 Itinerary</button>
          <button class="btn secondary" onclick="location.hash='#explore'">探索推薦 Explore</button>
        </div>
        <div class="footerNote">Tip：收藏景點/美食會用 ⭐ 存在你的瀏覽器。</div>
      </div>

      <div class="card">
        <div class="muted">Quick Picks</div>
        <h2 class="title" style="font-size:18px;margin-top:6px;">熱門收藏</h2>
        <div class="list">
          ${renderFavList()}
        </div>
      </div>
    </div>
  `;
}

function renderFavList(){
  const favArr = [...favs].map(id=>placeById[id]).filter(Boolean);
  if(favArr.length === 0) return `<div class="muted">目前還沒有收藏，去 Explore 點 ⭐ 收藏吧。</div>`;
  return favArr.slice(0,5).map(p=>`
    <div class="item">
      <div>
        <h3>${p.name}</h3>
        <p>${labelType(p.type)} · ${p.area}</p>
      </div>
      <div class="right">
        <span class="star on" title="取消收藏" onclick="star('${p.id}')">★</span>
      </div>
    </div>
  `).join("");
}

function renderTrips(){
  app.innerHTML = `
    <div class="card">
      <h1 class="title">Trips</h1>
      <div class="list">
        ${trips.map(t=>`
          <div class="item">
            <div>
              <h3>${t.name}</h3>
              <p>${t.city} · ${t.days} days · ${t.date}</p>
            </div>
            <div class="right">
              <button class="btn secondary" onclick="location.hash='#itinerary'">Open itinerary</button>
            </div>
          </div>
        `).join("")}
      </div>
    </div>
  `;
}

function renderItinerary(){
  const tripId = trips[0].id;
  const days = itinerary[tripId] || [];
  const dayOptions = days.map(d=>`<option value="${d.day}">Day ${d.day} · ${d.title}</option>`).join("");
  app.innerHTML = `
    <div class="card">
      <div class="row" style="justify-content:space-between;">
        <div>
          <div class="muted">Itinerary</div>
          <h1 class="title">${trips[0].name}</h1>
          <div class="muted">Day-by-day schedule</div>
        </div>
        <div class="right">
          <span class="small">跳到：</span>
          <select id="daySel">${dayOptions}</select>
          <button class="btn secondary" onclick="jumpDay()">Go</button>
        </div>
      </div>
      <div class="hr"></div>

      ${days.length ? days.map(d=>renderDayBlock(d)).join("") : `<div class="muted">尚未建立行程。</div>`}

      <div class="footerNote">想要 Day4~Day7？我可以教你照格式快速補上（超簡單）。</div>
    </div>
  `;
}

function renderDayBlock(dayPlan){
  return `
    <div class="card" id="day-${dayPlan.day}" style="margin:12px 0;">
      <div class="row" style="justify-content:space-between;">
        <div>
          <h2 class="title" style="font-size:18px;margin:0;">Day ${dayPlan.day} · ${dayPlan.title}</h2>
          <div class="muted">${dayPlan.items.length} items</div>
        </div>
      </div>
      <div class="timeline">
        ${dayPlan.items.map(it=>{
          const p = placeById[it.placeId];
          return `
            <div class="trow">
              <div class="time">${it.time}</div>
              <div>
                <div class="row" style="justify-content:space-between;">
                  <div>
                    <strong>${p ? p.name : it.placeId}</strong>
                    <div class="muted">${p ? `${labelType(p.type)} · ${p.area}` : ""}</div>
                    ${it.note ? `<div class="small">${it.note}</div>` : ``}
                  </div>
                  <div class="right">
                    <span class="star ${favs.has(it.placeId) ? "on" : ""}" onclick="star('${it.placeId}')"
                      title="${favs.has(it.placeId) ? "取消收藏" : "加入收藏"}">${favs.has(it.placeId) ? "★" : "☆"}</span>
                  </div>
                </div>
              </div>
            </div>
          `;
        }).join("")}
      </div>
    </div>
  `;
}

function jumpDay(){
  const v = document.getElementById("daySel").value;
  const el = document.getElementById("day-"+v);
  if(el) el.scrollIntoView({behavior:"smooth",block:"start"});
}

function renderExplore(){
  app.innerHTML = `
    <div class="card">
      <div class="row" style="justify-content:space-between;align-items:flex-end;">
        <div>
          <div class="muted">Explore</div>
          <h1 class="title">推薦景點 / 美食</h1>
          <div class="muted">搜尋、篩選、收藏 ⭐</div>
        </div>
        <div class="right">
          <input id="q" placeholder="Search name / area / tag..." oninput="applyFilter()"/>
        </div>
      </div>

      <div class="hr"></div>

      <div class="row" id="filters">
        ${renderFilterPills("all")}
      </div>

      <div class="hr"></div>

      <div class="list" id="placeList"></div>
      <div class="footerNote">Tip：點 ⭐ 會收藏；回 Home 會看到收藏清單。</div>
    </div>
  `;

  // 初始渲染清單
  window.__type = "all";
  applyFilter();
}

function renderFilterPills(active){
  const types = [
    {k:"all", t:"All"},
    {k:"spot", t:"Spots"},
    {k:"food", t:"Food"},
    {k:"cafe", t:"Cafe"},
    {k:"dessert", t:"Dessert"},
  ];
  return types.map(x=>`
    <span class="pill ${active===x.k?"active":""}" onclick="setType('${x.k}')">${x.t}</span>
  `).join("");
}

function setType(type){
  window.__type = type;
  document.getElementById("filters").innerHTML = renderFilterPills(type);
  applyFilter();
}

function applyFilter(){
  const q = (document.getElementById("q")?.value || "").toLowerCase().trim();
  const type = window.__type || "all";

  const filtered = places.filter(p=>{
    const matchType = (type==="all") ? true : p.type === type;
    const hay = (p.name+" "+p.area+" "+(p.tags||[]).join(" ")).toLowerCase();
    const matchQ = q ? hay.includes(q) : true;
    return matchType && matchQ;
  });

  const list = document.getElementById("placeList");
  if(!filtered.length){
    list.innerHTML = `<div class="muted">沒有符合的結果，換個關鍵字試試。</div>`;
    return;
  }
  list.innerHTML = filtered.map(p=>`
    <div class="item">
      <div>
        <h3>${p.name}</h3>
        <p>${labelType(p.type)} · ${p.area} ${p.tags?.length? "· #"+p.tags.join(" #"):""}</p>
      </div>
      <div class="right">
        <span class="star ${favs.has(p.id) ? "on" : ""}" onclick="star('${p.id}')"
          title="${favs.has(p.id) ? "取消收藏" : "加入收藏"}">${favs.has(p.id) ? "★" : "☆"}</span>
      </div>
    </div>
  `).join("");
}

function labelType(t){
  const map = { spot:"景點", food:"美食", cafe:"咖啡", dessert:"甜點" };
  return map[t] || t;
}

render();
</script>
</body>
</html>
